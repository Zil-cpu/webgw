<!DOCTYPE html>
<html>
<script src="https://unpkg.com/html5-qrcode"></script>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sains Quality Computer</title>

<link rel="icon" href="logo.png">

<style>
body{
font-family:Arial;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
margin:0;
color:white;
text-align:center;
}

.header{
background:black;
padding:15px;
font-size:22px;
font-weight:bold;
}

.jam{
font-size:18px;
margin-top:5px;
color:#00ffcc;
}

.container{
background:white;
color:black;
margin:20px;
padding:20px;
border-radius:15px;
box-shadow:0 0 20px rgba(0,0,0,0.4);
}

input,select,button{
padding:10px;
margin:5px;
width:90%;
border-radius:8px;
border:1px solid #ccc;
}

button{
background:#007bff;
color:white;
font-weight:bold;
}

button:hover{
background:#0056b3;
}

table{
width:100%;
margin-top:15px;
border-collapse:collapse;
}

th,td{
border:1px solid #ccc;
padding:8px;
}

th{
background:#007bff;
color:white;
}

.logo{
width:80px;
margin-top:10px;
}

.loginbox{
margin-top:100px;
}

</style>
</head>

<body>

<div id="loginPage" class="loginbox">
<img src="logo.png" class="logo">
<h2>Sains Quality Computer</h2>
<input type="password" id="pass" placeholder="Password">
<br>
<button onclick="login()">LOGIN</button>
</div>

<div id="app" style="display:none;">
<div class="header">
Sains Quality Service Center
<div class="jam" id="jam"></div>
</div>

<div class="container">
<h3>Input Barang Service</h3>

<input id="nama" placeholder="Nama Barang">
<input id="sn" placeholder="Serial Number">
<button onclick="startScan()">SCAN BARCODE</button>
<div id="reader" style="width:250px;margin:auto;"></div>

<select id="status">
<option>Masuk</option>
<option>Selesai</option>
<option>Diambil</option>
</select>

<br>
<button onclick="tambah()">SIMPAN</button>
<button onclick="download()">DOWNLOAD EXCEL</button>
<button onclick="backup()">BACKUP DATA</button>
<button onclick="restore()">RESTORE DATA</button>
<button onclick="printStruk()">PRINT STRUK TOKO</button>
<button onclick="printPDF()">PRINT PDF</button>

<table id="tabel">
<tr>
<th>Waktu</th>
<th>Barang</th>
<th>SN</th>
<th>Status</th>
<th>Hapus</th>
</tr>
</table>

function backup(){
let data = localStorage.getItem("tabel");
let blob = new Blob([data]);
let a = document.createElement("a");
a.href = URL.createObjectURL(blob);
a.download = "backup_toko.txt";
a.click();
}

function restore(){
let data = prompt("Paste data backup disini:");
if(data){
localStorage.setItem("tabel",data);
location.reload();
}
}

</div>
</div>




<audio id="beep">
<source src="https://www.soundjay.com/misc/sounds/barcode-beep.mp3">
</audio>


<script>

function login(){
let p=document.getElementById("pass").value;
if(p==="Elmijimo123"){
document.getElementById("loginPage").style.display="none";
document.getElementById("app").style.display="block";
}else{
alert("Password salah");
}
}

function jam(){
let t=new Date();
document.getElementById("jam").innerHTML=t.toLocaleString();
}
setInterval(jam,1000);

function tambah(){
let nama=document.getElementById("nama").value;
let sn=document.getElementById("sn").value;
let status=document.getElementById("status").value;

if(nama==""){alert("Isi barang");return;}

let waktu=new Date().toLocaleString();

let row=document.getElementById("tabel").insertRow();
row.insertCell(0).innerHTML=waktu;
row.insertCell(1).innerHTML=nama;
row.insertCell(2).innerHTML=sn;
row.insertCell(3).innerHTML=status;
let btn = row.insertCell(4);
btn.innerHTML = "<button onclick='hapus(this)'>Hapus</button>";


document.getElementById("beep").play();

saveData();
}

function saveData(){
localStorage.setItem("tabel",document.getElementById("tabel").innerHTML);
}

window.onload=function(){
if(localStorage.getItem("tabel")){
document.getElementById("tabel").innerHTML=localStorage.getItem("tabel");
}
}

function download(){
let table=document.getElementById("tabel").outerHTML;
let url='data:application/vnd.ms-excel,'+ encodeURIComponent(table);
let link=document.createElement("a");
link.href=url;
link.download="data_service.xls";
link.click();
}

function printPDF(){
let isi = document.getElementById("tabel").outerHTML;
let win = window.open("");
win.document.write("<h2>Sains Quality Service Center</h2>");
win.document.write(isi);
win.print();
}

function printStruk(){

let table = document.getElementById("tabel");
let rows = table.rows;

let isi = "";

for(let i=1;i<rows.length;i++){
let col = rows[i].cells;
isi += `
<tr>
<td>${col[0].innerHTML}</td>
<td>${col[1].innerHTML}</td>
<td>${col[2].innerHTML}</td>
<td>${col[3].innerHTML}</td>
</tr>
`;
}

let win = window.open("","","width=400,height=600");

win.document.write(`
<html>
<head>
<title>Print</title>
<style>
body{font-family:monospace;text-align:center;}
table{width:100%;border-collapse:collapse;}
td{border-bottom:1px dashed #000;padding:4px;font-size:12px;}
h2{margin:5px;}
</style>
</head>
<body>

<h2>Sains Quality</h2>
<b>Service Center</b>
<hr>
${new Date().toLocaleString()}
<hr>

<table>
<tr>
<td>Waktu</td>
<td>Barang</td>
<td>SN</td>
<td>Status</td>
</tr>
${isi}
</table>

<hr>
Terima kasih üôè<br>
Barang harap diambil tepat waktu
<br><br>
TTD Customer
<br><br><br>
_____________

</body>
</html>
`);

win.print();
}

function startScan(){
document.getElementById("reader").innerHTML="";

let scanner = new Html5Qrcode("reader");

scanner.start(
{ facingMode: "environment" },
{ fps: 10, qrbox: 250 },
(qrCodeMessage)=>{
document.getElementById("sn").value = qrCodeMessage;
scanner.stop();
document.getElementById("reader").innerHTML="";
document.getElementById("beep").play();
},
(errorMessage)=>{}
);
}

function hapus(btn){
if(confirm("Hapus data ini?")){
let row = btn.parentNode.parentNode;
row.remove();
saveData();
}
}

</script>
</body>
</html>












