<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sains Quality Service Center</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body{
font-family:Arial;
background:linear-gradient(to right,#2c5364,#203a43,#0f2027);
color:#fff;
text-align:center;
}

.box{
background:#fff;
color:#000;
width:350px;
margin:40px auto;
padding:20px;
border-radius:12px;
box-shadow:0 0 15px rgba(0,0,0,0.4);
}

input,select{
width:90%;
padding:10px;
margin:5px;
border-radius:6px;
border:1px solid #ccc;
}

button{
padding:10px 20px;
margin:5px;
border:none;
border-radius:6px;
background:#2c5364;
color:#fff;
cursor:pointer;
}

button:hover{background:#203a43;}

#dashboard{display:none}

table{
width:95%;
margin:auto;
background:#fff;
color:#000;
border-collapse:collapse;
margin-top:20px;
}
td,th{padding:8px;border:1px solid #ccc}

.logo{width:160px;margin-bottom:10px;}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
<h2>üîß Sains Quality Service Center</h2>
<input type="password" id="pass" placeholder="Password">
<br>
<button onclick="login()">MASUK</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard">

<h2>üìã INPUT SERVICE</h2>

<input type="text" id="no_service" readonly placeholder="No Service"><br>
<input type="text" id="nama" placeholder="Nama Customer"><br>
<input type="text" id="barang" placeholder="Nama Barang"><br>
<input type="text" id="keluhan" placeholder="Keluhan"><br>
<input type="number" id="biaya" placeholder="Biaya Service (Rp)"><br>

<select id="status">
<option>Masuk</option>
<option>Proses</option>
<option>Selesai</option>
<option>Diambil</option>
</select><br>

<button onclick="simpan()">üíæ Simpan</button>
<button onclick="exportExcel()">üìä Excel</button>

<h3>üì¶ Data Service</h3>

<table id="tabel">
<tr>
<th>No</th>
<th>Jam</th>
<th>Nama</th>
<th>Barang</th>
<th>Keluhan</th>
<th>Status</th>
<th>Struk</th>
</tr>
</table>

</div>

<script>

function login(){
let p=document.getElementById("pass").value;
if(p=="12345"){
document.getElementById("loginBox").style.display="none";
document.getElementById("dashboard").style.display="block";
document.getElementById("no_service").value = generateNoService();
loadData();
}else{
alert("Password salah");
}
}

// waktu
function waktu(){
let now=new Date();
return now.toLocaleString("id-ID");
}

// AUTO NOMOR
function generateNoService(){
let last = localStorage.getItem("service_no");

if(last){
last=parseInt(last)+1;
}else{
last=1;
}

localStorage.setItem("service_no",last);
return "SRV-"+String(last).padStart(4,'0');
}


// SIMPAN DATA
// SIMPAN DATA
function simpan(){
let no=document.getElementById("no_service").value;
let nama=document.getElementById("nama").value;
let barang=document.getElementById("barang").value;
let keluhan=document.getElementById("keluhan").value;
let biaya=document.getElementById("biaya").value || 0;
let status=document.getElementById("status").value;
let jam=waktu();

if(nama==""){alert("Isi nama bro");return;}

let data=JSON.parse(localStorage.getItem("service")||"[]");

data.push({no,jam,nama,barang,keluhan,biaya,status});
localStorage.setItem("service",JSON.stringify(data));

loadData();

// reset form
document.getElementById("nama").value="";
document.getElementById("barang").value="";
document.getElementById("keluhan").value="";
document.getElementById("biaya").value="";

document.getElementById("no_service").value = generateNoService();
}




// LOAD DATA
function loadData(){
let data=JSON.parse(localStorage.getItem("service")||"[]");

let html=`<tr>
<th>No</th>
<th>Jam</th>
<th>Nama</th>
<th>Barang</th>
<th>Keluhan</th>
<th>Biaya</th>
<th>Status</th>
<th>Struk</th>
</tr>`;


data.forEach(d=>{
html+=`<tr>
<td>${d.no}</td>
<td>${d.jam}</td>
<td>${d.nama}</td>
<td>${d.barang}</td>
<td>${d.keluhan}</td>
<td>Rp ${parseInt(d.biaya||0).toLocaleString()}</td>
<td>${d.status}</td>
<td><button onclick='printStruk(${JSON.stringify(d)})'>üßæ</button></td>
</tr>`;
});


document.getElementById("tabel").innerHTML=html;
}

// PRINT STRUK
function printStruk(d){
let win=window.open("","","width=350,height=600");

win.document.write(`
<center>
<img src="logo.png" width="150"><br>
<b style="font-size:18px">SAINS QUALITY SERVICE</b><br>
Computer & Service<hr>

No: <b>${d.no}</b><br>
${d.jam}<hr>

Nama: ${d.nama}<br>
Barang: ${d.barang}<br>
Keluhan: ${d.keluhan}<br>
Status: <b>${d.status}</b><br>

<hr>
Terima kasih üôè<br>
Garansi Service
</center>
`);

win.document.close();
win.print();
}

// EXCEL
function exportExcel(){
let data=JSON.parse(localStorage.getItem("service")||"[]");
let ws=XLSX.utils.json_to_sheet(data);
let wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"Service");
XLSX.writeFile(wb,"data_service.xlsx");
}

</script>
</body>
</html>

