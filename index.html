<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Service Barang</title>

<style>
body{
font-family:Arial;
background:#0f172a;
color:white;
padding:20px;
}
h1{text-align:center}
.box{
max-width:400px;
margin:auto;
background:#111827;
padding:20px;
border-radius:12px;
}
input,select,button{
padding:10px;
margin:5px;
width:90%;
border-radius:8px;
border:none;
}
button{
background:#22c55e;
color:white;
cursor:pointer;
}
table{
width:100%;
border-collapse:collapse;
background:#111827;
margin-top:20px;
}
th,td{
padding:10px;
border:1px solid #333;
text-align:center;
}
.hapus{
background:red;
color:white;
padding:5px 10px;
border:none;
border-radius:5px;
cursor:pointer;
}
</style>
</head>

<body>

<div id="login">
<div class="box">
<h2>üîê Login Admin</h2>
<input type="text" id="user" placeholder="Username">
<input type="password" id="pass" placeholder="Password">
<button onclick="login()">Login</button>
</div>
</div>

<div id="app" style="display:none;">
<h1>üì¶ DATA BARANG SERVICE</h1>

<form onsubmit="tambahData(); return false;">
<input type="text" id="tanggal" placeholder="Tanggal" required>
<input type="text" id="nama" placeholder="Nama Barang" required>
<input type="text" id="customer" placeholder="Customer" required>

<select id="status">
<option value="Masuk">Barang Masuk</option>
<option value="Keluar">Barang Keluar</option>
</select>

<br>
<button type="submit">Simpan</button>
<button type="button" onclick="logout()" style="background:red;">Logout</button>
</form>

<button type="button" onclick="downloadExcel()" style="background:blue;">
Download Excel
</button>

<button type="button" onclick="printData()" style="background:orange;">
Print Laporan
</button>

<table>
<thead>
<tr>
<th>Tanggal</th>
<th>Barang</th>
<th>Customer</th>
<th>Status</th>
<th>Hapus</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table>
</div>

<script>
let data = JSON.parse(localStorage.getItem("service")) || [];

function login(){
let u=document.getElementById("user").value;
let p=document.getElementById("pass").value;

if(u==="admin" && p==="12345"){
document.getElementById("login").style.display="none";
document.getElementById("app").style.display="block";
}else{
alert("Login salah bro!");
}
}

function logout(){
location.reload();
}

function tampil(){
let isi="";
data.forEach((d,i)=>{
isi+=`<tr>
<td>${d.tanggal}</td>
<td>${d.nama}</td>
<td>${d.customer}</td>
<td>${d.status}</td>
<td><button class="hapus" onclick="hapus(${i})">X</button></td>
</tr>`;
});
document.getElementById("tabel").innerHTML=isi;
}

function tambahData(){
let d={
tanggal:document.getElementById("tanggal").value,
nama:document.getElementById("nama").value,
customer:document.getElementById("customer").value,
status:document.getElementById("status").value
};
data.push(d);
localStorage.setItem("service",JSON.stringify(data));
tampil();
document.querySelector("form").reset();
}

function hapus(i){
data.splice(i,1);
localStorage.setItem("service",JSON.stringify(data));
tampil();
function downloadExcel(){
let csv = "Tanggal,Barang,Customer,Status\n";

data.forEach(d=>{
csv += `${d.tanggal},${d.nama},${d.customer},${d.status}\n`;
});

let blob = new Blob([csv], { type: 'text/csv' });
let url = window.URL.createObjectURL(blob);

let a = document.createElement("a");
a.href = url;
a.download = "data_service.csv";
a.click();
}

}

tampil();

function printData(){
let isi = `
<h2>DATA SERVICE BARANG</h2>
<table border="1" style="border-collapse:collapse;width:100%;">
<tr>
<th>Tanggal</th>
<th>Barang</th>
<th>Customer</th>
<th>Status</th>
</tr>
`;

data.forEach(d=>{
isi += `<tr>
<td>${d.tanggal}</td>
<td>${d.nama}</td>
<td>${d.customer}</td>
<td>${d.status}</td>
</tr>`;
});

isi += "</table>";

let win = window.open("", "", "width=900,height=700");
win.document.write(isi);
win.print();
}
</script>






</body>
</html>






