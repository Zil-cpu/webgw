<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sains Quality Service Center</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
body{
font-family:Arial;
background:#0f2027;
background:linear-gradient(to right,#2c5364,#203a43,#0f2027);
color:#fff;
text-align:center;
}

.box{
background:#fff;
color:#000;
width:350px;
margin:40px auto;
padding:20px;
border-radius:12px;
box-shadow:0 0 15px rgba(0,0,0,0.4);
}

input,select{
width:90%;
padding:10px;
margin:5px;
border-radius:6px;
border:1px solid #ccc;
}

button{
padding:10px 20px;
margin:5px;
border:none;
border-radius:6px;
background:#2c5364;
color:#fff;
cursor:pointer;
}

button:hover{
background:#203a43;
}

#dashboard{display:none}
table{
width:95%;
margin:auto;
background:#fff;
color:#000;
border-collapse:collapse;
}
td,th{padding:8px;border:1px solid #ccc}

.logo{
width:180px;
margin-bottom:10px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="box" id="loginBox">
<h2>ðŸ”§ Sains Quality Service Center</h2>
<input type="password" id="pass" placeholder="Password">
<br>
<button onclick="login()">MASUK</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard">

<h2>ðŸ“‹ INPUT SERVICE</h2>

<input type="text" id="nama" placeholder="Nama Customer"><br>
<input type="text" id="barang" placeholder="Nama Barang"><br>
<input type="text" id="keluhan" placeholder="Keluhan"><br>

<select id="status">
<option>Masuk</option>
<option>Proses</option>
<option>Selesai</option>
<option>Diambil</option>
</select><br>

<button onclick="simpan()">ðŸ’¾ Simpan</button>
<button onclick="exportExcel()">ðŸ“Š Export Excel</button>
<button onclick="printStruk()">ðŸ§¾ Print</button>

<h3>ðŸ“¦ Data Service</h3>

<table id="tabel">
<tr>
<th>Jam</th>
<th>Nama</th>
<th>Barang</th>
<th>Keluhan</th>
<th>Status</th>
</tr>
</table>

</div>

<script>

function login(){
let p=document.getElementById("pass").value;
if(p=="12345"){
document.getElementById("loginBox").style.display="none";
document.getElementById("dashboard").style.display="block";
loadData();
}else{
alert("Password salah");
}
}

function waktu(){
let now=new Date();
return now.toLocaleString();
}

function simpan(){
let nama=document.getElementById("nama").value;
let barang=document.getElementById("barang").value;
let keluhan=document.getElementById("keluhan").value;
let status=document.getElementById("status").value;
let jam=waktu();

if(nama==""){alert("Isi nama");return;}

let data=JSON.parse(localStorage.getItem("service")||"[]");

data.push({jam,nama,barang,keluhan,status});
localStorage.setItem("service",JSON.stringify(data));

loadData();

document.getElementById("nama").value="";
document.getElementById("barang").value="";
document.getElementById("keluhan").value="";
}

function loadData(){
let data=JSON.parse(localStorage.getItem("service")||"[]");
let html=`<tr>
<th>Jam</th>
<th>Nama</th>
<th>Barang</th>
<th>Keluhan</th>
<th>Status</th>
</tr>`;

data.forEach(d=>{
html+=`<tr>
<td>${d.jam}</td>
<td>${d.nama}</td>
<td>${d.barang}</td>
<td>${d.keluhan}</td>
<td>${d.status}</td>
</tr>`;
});

document.getElementById("tabel").innerHTML=html;
}

function exportExcel(){
let data=JSON.parse(localStorage.getItem("service")||"[]");
let ws=XLSX.utils.json_to_sheet(data);
let wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"Service");
XLSX.writeFile(wb,"data_service.xlsx");
}

function printStruk(){
let nama=document.getElementById("nama").value;
let barang=document.getElementById("barang").value;
let keluhan=document.getElementById("keluhan").value;
let jam=waktu();

let win=window.open("");
win.document.write(`
<center>
<img src="https://i.imgur.com/8Km9tLL.png" width="200"><br>
<h3>Sains Quality Computer</h3>
${jam}<hr>
Nama: ${nama}<br>
Barang: ${barang}<br>
Keluhan: ${keluhan}<br>
<hr>Terima kasih
</center>
`);
win.print();
}

</script>
</body>
</html>











