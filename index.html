<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sains Quality Service Center</title>

<style>
body{
font-family:Arial;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
text-align:center;
margin:0;
padding:0;
}

.box{
background:white;
color:black;
padding:20px;
margin:20px;
border-radius:15px;
}

input,button,select{
padding:12px;
margin:5px;
width:90%;
border-radius:10px;
border:1px solid #ccc;
font-size:16px;
}

button{
background:#2196f3;
color:white;
border:none;
font-weight:bold;
cursor:pointer;
}
button:hover{background:#0b7dda;}

table{
width:100%;
background:white;
color:black;
margin-top:20px;
border-radius:10px;
}

td,th{
padding:10px;
border-bottom:1px solid #ddd;
font-size:14px;
}

img.preview{width:70px;}
</style>
</head>

<body>

<h2>ðŸ”§ Sains Quality Service Center</h2>

<div class="box" id="loginBox">
<h3>LOGIN TOKO</h3>
<input type="password" id="pass" placeholder="Password">
<button onclick="login()">MASUK</button>
</div>

<div id="app" style="display:none">

<div class="box">
<h3>INPUT SERVICE</h3>

<input id="nama" placeholder="Nama Customer">
<input id="barang" placeholder="Nama Barang">
<input id="ket" placeholder="Keterangan / Keluhan">
<input type="file" id="foto" accept="image/*">

<button onclick="simpan()">ðŸ’¾ SIMPAN</button>
<button onclick="downloadExcel()">ðŸ“¥ DOWNLOAD EXCEL</button>
<button onclick="printData()">ðŸ–¨ PRINT DATA</button>
</div>

<div class="box">
<h3>DATA SERVICE</h3>
<table id="tabel"></table>
</div>

</div>

<script>
let db = JSON.parse(localStorage.getItem("db")) || []

function login(){
let p=document.getElementById("pass").value
if(p==="12345"){
loginBox.style.display="none"
app.style.display="block"
render()
}else alert("Password salah bro")
}

function getNextNo(){
let last = localStorage.getItem("noService") || 0
last++
localStorage.setItem("noService", last)
return "SRV-"+String(last).padStart(4,"0")
}

function simpan(){
let nama=document.getElementById("nama").value
let barang=document.getElementById("barang").value
let ket=document.getElementById("ket").value
let file=document.getElementById("foto").files[0]

if(!nama||!barang){alert("Isi dulu bro");return}

let no=getNextNo()
let status="Proses"
let waktu=new Date().toLocaleString()

if(file){
let reader=new FileReader()
reader.onload=function(e){
db.push({no,nama,barang,ket,status,waktu,foto:e.target.result})
save()
printStruk({no,nama,barang,ket,status,waktu})
}
reader.readAsDataURL(file)
}else{
db.push({no,nama,barang,ket,status,waktu,foto:""})
save()
printStruk({no,nama,barang,ket,status,waktu})
}

nama.value=""
barang.value=""
ket.value=""
foto.value=""
}

function save(){
localStorage.setItem("db",JSON.stringify(db))
render()
}

function render(){
let t=document.getElementById("tabel")

t.innerHTML=`<tr>
<th>No</th>
<th>Nama</th>
<th>Barang</th>
<th>Status</th>
<th>Cetak</th>
<th>Hapus</th>
</tr>`

db.forEach((d,i)=>{
t.innerHTML+=`
<tr>
<td>${d.no}</td>
<td>${d.nama}</td>
<td>${d.barang}</td>
<td>
<select onchange="ubahStatus(${i},this.value)">
<option ${d.status=="Proses"?"selected":""}>Proses</option>
<option ${d.status=="Selesai"?"selected":"











































