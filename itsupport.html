<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IT Support Ticket</title>

<style>
body{
    font-family: 'Segoe UI', sans-serif;
    margin:0;
    background: linear-gradient(135deg,#1e3c72,#2a5298);
}

.container{
    max-width:1000px;
    margin:40px auto;
    background:white;
    padding:30px;
    border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
}

h1{
    text-align:center;
    color:#2a5298;
}

form{
    display:grid;
    gap:15px;
}

input, select, textarea{
    padding:10px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:14px;
}

textarea{
    resize:none;
}

button{
    padding:10px;
    border:none;
    border-radius:8px;
    background:#2a5298;
    color:white;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}

button:hover{
    background:#1e3c72;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}

th{
    background:#2a5298;
    color:white;
    padding:10px;
}

td{
    padding:10px;
    border-bottom:1px solid #ddd;
}

tr:hover{
    background:#f5f5f5;
}

.status-open{
    color:red;
    font-weight:bold;
}

.status-done{
    color:green;
    font-weight:bold;
}

.admin-box{
    margin-top:30px;
    padding:15px;
    background:#f8f9fa;
    border-radius:10px;
}

/* DARK MODE */
.dark-mode{
    background: #121212 !important;
    color: white !important;
}

.dark-mode .container{
    background: #1e1e1e;
    color: white;
}

.dark-mode h1{
    color: #4da3ff;
}

.dark-mode table th{
    background:#333;
}

.dark-mode table td{
    border-bottom:1px solid #444;
}

.dark-mode input,
.dark-mode select,
.dark-mode textarea{
    background:#2a2a2a;
    color:white;
    border:1px solid #555;
}

</style>
</head>

<body>

<div class="container">
<div id="clock" style="text-align:right; font-weight:bold; color:#2a5298;"></div>
<h1>IT Support Ticket System</h1>


<form onsubmit="createTicket(event)">
    <input type="text" id="nama" placeholder="Nama Pelapor" required>

    <select id="departemen" required>
        <option value="">-- Pilih Departemen --</option>
        <option>IT</option>
        <option>Redaksi</option>
        <option>Listener</option>
        <option>Medsos</option>
        <option>Editor</option>
        <option>Operator</option>
        <option>Website</option>
        <option>HRD</option>
        <option>GA</option>
        <option>Finance</option>
        <option>Marketing</option>
        <option>Indorent</option>
    </select>

    <textarea id="deskripsi" placeholder="Deskripsi Kendala" rows="3" required></textarea>
    <textarea id="penyelesaian" placeholder="Penyelesaian (diisi IT)" rows="3"></textarea>

    <button type="submit">Buat Tiket</button>
</form>



<hr>

<h2>Daftar Tiket</h2>
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Nama</th>
            <th>Departemen</th>
            <th>Deskripsi</th>
            <th>Penyelesaian</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody id="ticketTable"></tbody>
</table>

</div>

<script>
function getTodayDate(){
    const today = new Date();
    const year = today.getFullYear();
    const month = String(today.getMonth() + 1).padStart(2,'0');
    const day = String(today.getDate()).padStart(2,'0');
    return `${year}${month}${day}`;
}

function updateClock(){
    const now = new Date();

    const jam = String(now.getHours()).padStart(2,'0');
    const menit = String(now.getMinutes()).padStart(2,'0');
    const detik = String(now.getSeconds()).padStart(2,'0');

    const tanggal = now.toLocaleDateString('id-ID', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });

    document.getElementById("clock").innerHTML =
        tanggal + " | " + jam + ":" + menit + ":" + detik;
}

setInterval(updateClock, 1000);
updateClock();

// Load tiket saat halaman dibuka
window.onload = function(){
    const tickets = JSON.parse(localStorage.getItem("tickets")) || [];
    tickets.forEach(ticket => addRow(ticket));
};

function createTicket(e){
    e.preventDefault();

    const nama = document.getElementById("nama").value;
    const departemen = document.getElementById("departemen").value;
    const deskripsi = document.getElementById("deskripsi").value;
    const penyelesaian = document.getElementById("penyelesaian").value;

    const today = getTodayDate();
    let counterKey = "ticketCounter_" + today;
    let counter = localStorage.getItem(counterKey)
        ? parseInt(localStorage.getItem(counterKey))
        : 1;

    const ticketNumber = `TCK-${today}-${String(counter).padStart(4,'0')}`;

    const ticketData = {
        id: ticketNumber,
        nama: nama,
        departemen: departemen,
        deskripsi: deskripsi,
        penyelesaian: penyelesaian,
        status: penyelesaian ? "DONE" : "OPEN"
    };

    addRow(ticketData);

    const tickets = JSON.parse(localStorage.getItem("tickets")) || [];
    tickets.push(ticketData);
    localStorage.setItem("tickets", JSON.stringify(tickets));

    counter++;
    localStorage.setItem(counterKey, counter);

    e.target.reset();
}

function addRow(ticket){
    const table = document.getElementById("ticketTable");
    const row = table.insertRow();

    row.innerHTML = `
        <td>${ticket.id}</td>
        <td>${ticket.nama}</td>
        <td>${ticket.departemen}</td>
        <td>${ticket.deskripsi}</td>
        <td>${ticket.penyelesaian || '-'}</td>
        <td class="${ticket.status === 'OPEN' ? 'status-open' : 'status-done'}">
            ${ticket.status}
        </td>
    `;
}
</script>




</body>
</html>
